<!DOCTYPE html>
<html lang="el" class="light">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
Â  Â  <meta name="description" content="MediRadar - Î’ÏÎµÎ¯Ï„Îµ Ï†Î¬ÏÎ¼Î±ÎºÎ± Î¬Î¼ÎµÏƒÎ± ÎºÎ±Î¹ Ï„Î¿Ï€Î¹ÎºÎ¬.">
Â  Â  <meta name="apple-mobile-web-app-capable" content="yes">
Â  Â  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
Â  Â  <meta name="theme-color" content="#0d9488">
Â  Â  <link rel="manifest" href="manifest.json">
Â  Â  <link rel="apple-touch-icon" href="icons/icon-192.png">

Â  Â  <title>MediRadar App</title>
Â  Â Â 
Â  Â  Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
Â  Â  <script src="https://unpkg.com/@phosphor-icons/web"></script>
Â  Â  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
Â  Â  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
Â  Â Â 
Â  Â  <script>
Â  Â  Â  Â  tailwind.config = {
Â  Â  Â  Â  Â  Â  darkMode: 'class',
Â  Â  Â  Â  Â  Â  theme: {
Â  Â  Â  Â  Â  Â  Â  Â  extend: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fontFamily: { sans: ['Inter', 'sans-serif'] },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  colors: { primary: '#0d9488', secondary: '#0f172a' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  animation: {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'fade-in': 'fadeIn 0.3s ease-out forwards',Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'slide-up': 'slideUp 0.3s ease-out forwards'Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  keyframes: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </script>

Â  Â  <style>
Â  Â  Â  Â  html { -webkit-tap-highlight-color: transparent; } body { overscroll-behavior-y: none; }
Â  Â  Â  Â  .emoji-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 0; pointer-events: none; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); transition: background 0.5s ease; }
Â  Â  Â  Â  html.dark .emoji-bg { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); }
Â  Â  Â  Â  .emoji { position: absolute; bottom: -100px; font-size: 2rem; opacity: 0.4; animation: floatUp 15s linear infinite; z-index: 0; }
Â  Â  Â  Â  @keyframes floatUp { 0% { transform: translateY(0) rotate(0deg); opacity: 0; } 10% { opacity: 0.5; } 90% { opacity: 0.5; } 100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; } }
Â  Â  Â  Â  .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.8); box-shadow: 0 10px 40px -10px rgba(0,0,0,0.1); position: relative; z-index: 10; transition: all 0.3s ease; }
Â  Â  Â  Â  html.dark .glass-card { background: rgba(30, 41, 59, 0.95); border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 10px 40px -10px rgba(0,0,0,0.3); }
Â  Â  Â  Â  .tab-content { display: none; animation: fadeIn 0.3s ease-out; } .tab-content.active { display: block; }
Â  Â  Â  Â  #drug-suggestions, #city-suggestions { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #e2e8f0; border-radius: 0.75rem; max-height: 200px; overflow-y: auto; z-index: 50; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); display: none; margin-top: 4px; }
Â  Â  Â  Â  html.dark #drug-suggestions, html.dark #city-suggestions { background: #1e293b; border-color: #334155; }
Â  Â  Â  Â  .suggestion-item { padding: 0.75rem 1rem; cursor: pointer; font-size: 0.875rem; border-bottom: 1px solid #f1f5f9; }Â 
Â  Â  Â  Â  html.dark .suggestion-item { border-color: #334155; color: #e2e8f0; } .suggestion-item:hover { background-color: #f0f9ff; } html.dark .suggestion-item:hover { background-color: #334155; }
Â  Â  Â  Â  .radar-pulse { width: 100px; height: 100px; background: rgba(13, 148, 136, 0.2); border-radius: 50%; position: relative; margin: 0 auto; }
Â  Â  Â  Â  .radar-pulse::before, .radar-pulse::after { content: ''; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); border-radius: 50%; border: 2px solid #0d9488; width: 100%; height: 100%; animation: ripple 2s linear infinite; opacity: 0; }
Â  Â  Â  Â  .radar-pulse::after { animation-delay: 1s; }
Â  Â  Â  Â  @keyframes ripple { 0% { width: 0; height: 0; opacity: 1; } 100% { width: 200%; height: 200%; opacity: 0; } }
Â  Â  Â  Â  .modal-backdrop { display: none; position: fixed; inset: 0; z-index: 9999; background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(4px); align-items: center; justify-content: center; padding: 1rem; }
Â  Â  Â  Â  .modal-backdrop.active { display: flex; animation: fadeIn 0.2s ease-out; }
Â  Â  Â  Â  .modal-content { width: 100%; max-width: 400px; border-radius: 1.5rem; padding: 2rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); transform: scale(0.95); opacity: 0; position: relative; z-index: 10000; }
Â  Â  Â  Â  .modal-backdrop.active .modal-content { animation: slideUp 0.3s ease-out forwards; }
Â  Â  Â  Â  *:focus-visible { outline: 2px solid #0d9488; outline-offset: 2px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Accessibility Classes */
Â  Â  Â  Â  .a11y-grayscale { filter: grayscale(100%) !important; } .a11y-high-contrast { filter: contrast(125%) brightness(90%) !important; } .a11y-links-underline a, .a11y-links-underline button { text-decoration: underline !important; text-decoration-thickness: 2px !important; } .a11y-readable-font * { font-family: sans-serif !important; letter-spacing: 0.05em !important; word-spacing: 0.1em !important; }
Â  Â  </style>
</head>
<body class="text-slate-800 dark:text-slate-100 antialiased min-h-screen relative flex flex-col pb-safe">

Â  Â  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:bg-white focus:text-primary focus:p-4 focus:rounded-xl focus:shadow-lg">ÎœÎµÏ„Î¬Î²Î±ÏƒÎ· ÏƒÏ„Î¿ ÎºÏÏÎ¹Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿</a>
Â  Â  <div id="emoji-container" class="emoji-bg" aria-hidden="true"></div>

Â  Â  <nav class="w-full max-w-lg mx-auto p-4 flex justify-between items-center z-20 relative pt-safe" aria-label="ÎšÏÏÎ¹Î± Ï€Î»Î¿Î®Î³Î·ÏƒÎ·">
Â  Â  Â  Â  <div class="flex gap-2" id="user-nav-container">
Â  Â  Â  Â  Â  Â  <button onclick="openModal('user')" aria-label="Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ Î® Î•Î³Î³ÏÎ±Ï†Î® Î§ÏÎ®ÏƒÏ„Î·" class="bg-white/90 dark:bg-slate-800/90 px-3 py-2 rounded-xl text-xs font-bold text-primary border border-primary/20 shadow-sm hover:shadow-md transition-all flex items-center gap-1 active:scale-95">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="ph ph-user text-lg" aria-hidden="true"></i> Î•Î¯ÏƒÎ¿Î´Î¿Ï‚
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="flex gap-2">
Â  Â  Â  Â  Â  Â  <button onclick="toggleLang()" aria-label="Î‘Î»Î»Î±Î³Î® Î“Î»ÏÏƒÏƒÎ±Ï‚" class="bg-white/60 dark:bg-slate-700/60 w-10 h-10 rounded-full flex items-center justify-center text-xl shadow-sm hover:scale-110 transition-transform border border-white/50 active:scale-95"><span id="lang-flag" aria-hidden="true">ğŸ‡¬ğŸ‡·</span></button>
Â  Â  Â  Â  Â  Â  <button onclick="toggleTheme()" aria-label="Î•Î½Î±Î»Î»Î±Î³Î® Î¦Ï‰Ï„ÎµÎ¹Î½Î¿Ï/Î£ÎºÎ¿Ï„ÎµÎ¹Î½Î¿Ï Î¸Î­Î¼Î±Ï„Î¿Ï‚" class="bg-white/60 dark:bg-slate-700/60 w-10 h-10 rounded-full flex items-center justify-center text-xl shadow-sm transition-transform border border-white/50 hover:scale-110 active:scale-95"><i id="theme-icon" class="ph ph-moon-stars" aria-hidden="true"></i></button>
Â  Â  Â  Â  </div>
Â  Â  </nav>

Â  Â  <main id="main-content" class="w-full max-w-lg mx-auto p-4 pb-6 flex-grow z-10 relative">
Â  Â  Â  Â  <header class="text-center mb-6">
Â  Â  Â  Â  Â  Â  <div class="inline-flex items-center justify-center bg-white/70 dark:bg-slate-700/70 p-4 rounded-2xl mb-3 shadow-sm backdrop-blur-sm border border-white/50" aria-hidden="true"><i class="ph ph-magnifying-glass text-4xl text-primary"></i></div>
Â  Â  Â  Â  Â  Â  <h1 class="text-3xl font-bold text-primary bg-clip-text text-transparent bg-gradient-to-r from-teal-600 to-cyan-500 drop-shadow-sm">MediRadar</h1>
Â  Â  Â  Â  Â  Â  <p class="text-slate-500 dark:text-slate-400 text-sm mt-1 font-medium" data-lang-key="subtitle">Î’ÏÎµÏ‚ Ï„Î¿ Ï†Î¬ÏÎ¼Î±ÎºÏŒ ÏƒÎ¿Ï… Î¬Î¼ÎµÏƒÎ± & Ï„Î¿Ï€Î¹ÎºÎ¬.</p>
Â  Â  Â  Â  </header>

Â  Â  Â  Â  <div class="flex p-1.5 bg-slate-200/80 dark:bg-slate-800/80 rounded-2xl mb-6 glass-card" role="tablist" aria-label="Î•Ï€Î¹Î»Î¿Î³Î­Ï‚ Ï€ÏÎ¿Î²Î¿Î»Î®Ï‚">
Â  Â  Â  Â  Â  Â  <button onclick="switchTab('search')" id="btn-search" role="tab" aria-selected="true" aria-controls="tab-search" class="flex-1 py-3 rounded-xl text-sm font-bold transition-all bg-white dark:bg-slate-700 shadow-sm text-primary dark:text-teal-300 ring-1 ring-black/5" data-lang-key="search_tab">Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·</button>
Â  Â  Â  Â  Â  Â  <button onclick="switchTab('how')" id="btn-how" role="tab" aria-selected="false" aria-controls="tab-how" class="flex-1 py-3 rounded-xl text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-white/50 dark:hover:bg-slate-700/50 transition-all" data-lang-key="how_tab">Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="tab-search" class="tab-content active" role="tabpanel" aria-labelledby="btn-search">
Â  Â  Â  Â  Â  Â  <div class="glass-card rounded-3xl p-6 relative overflow-hidden">
Â  Â  Â  Â  Â  Â  Â  Â  <form id="request-form" class="space-y-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2"><label for="full-name" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="name">ÎŸÎ½Î¿Î¼Î±</label><input id="full-name" type="text" placeholder="ÎœÎ±ÏÎ¯Î± Î ." oninput="saveUserData()" autocomplete="name" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 text-base focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all text-slate-900 dark:text-white font-medium shadow-sm" required></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2"><label for="phone" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="phone">Î¤Î·Î»ÎµÏ†Ï‰Î½Î¿</label><input id="phone" type="tel" placeholder="69..." oninput="saveUserData()" autocomplete="tel" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 text-base focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all text-slate-900 dark:text-white font-medium shadow-sm" required></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2 relative"><label for="city" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="area">Î ÎµÏÎ¹Î¿Ï‡Î·</label><div class="relative"><input id="city" type="text" placeholder="Î ÎµÏÎ¹Î¿Ï‡Î®..." oninput="saveUserData()" autocomplete="off" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 pr-32 text-base focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all text-slate-900 dark:text-white font-medium shadow-sm" required><div id="city-suggestions" role="listbox"></div><button type="button" onclick="getLocation()" aria-label="Î•Î½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒÏ‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±Ï‚" class="absolute right-2 top-2 bottom-2 px-3 bg-teal-100 dark:bg-teal-900/40 text-teal-800 dark:text-teal-200 border border-teal-200 dark:border-teal-700 rounded-xl text-xs font-bold hover:bg-teal-200 transition-colors flex items-center gap-1 shadow-sm active:scale-95"><i class="ph ph-navigation-arrow text-sm" aria-hidden="true"></i> <span data-lang-key="near_me">ÎšÎ¿Î½Ï„Î¬ Î¼Î¿Ï…</span></button></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="border-t-2 border-dashed border-slate-200 dark:border-slate-700 my-2" role="separator"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2 relative"><label for="medicine" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="med_name">ÎŸÎ½Î¿Î¼Î± Î¦Î±ÏÎ¼Î±ÎºÎ¿Ï…</label><div class="relative"><i class="ph ph-pill absolute left-4 top-4 text-slate-400 text-xl z-10" aria-hidden="true"></i><input id="medicine" type="text" placeholder="Ï€.Ï‡. Depon" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl pl-12 pr-12 py-3.5 text-base text-lg font-semibold focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all text-slate-900 dark:text-white shadow-sm" required autocomplete="off" enterkeyhint="search"><button type="button" onclick="startVoiceInput()" id="voice-btn" class="absolute right-2 top-2 bottom-2 w-10 h-10 rounded-full flex items-center justify-center text-xl text-slate-500 hover:text-primary transition-colors active:scale-95" title="Î¦Ï‰Î½Î·Ï„Î¹ÎºÎ® Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·" aria-label="Î¦Ï‰Î½Î·Ï„Î¹ÎºÎ® Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î¦Î±ÏÎ¼Î¬ÎºÎ¿Ï…"><i class="ph ph-microphone" aria-hidden="true"></i></button><div id="drug-suggestions" role="listbox"></div></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2"><label for="substance" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="substance">Î”ÏÎ±ÏƒÏ„Î¹ÎºÎ· (Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ¿)</label><input id="substance" type="text" placeholder="Ï€.Ï‡. Î Î±ÏÎ±ÎºÎµÏ„Î±Î¼ÏŒÎ»Î·" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 text-base outline-none focus:ring-2 focus:ring-primary/50 dark:text-white"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2"><label for="quantity" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="quantity">Î Î¿ÏƒÎ¿Ï„Î·Ï„Î±</label><input id="quantity" type="number" min="1" value="1" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 text-base text-center font-bold focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all text-slate-900 dark:text-white shadow-sm"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2"><label for="med-type" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="type">Î•Î¯Î´Î¿Ï‚ / ÎœÎ¿ÏÏ†Î®</label><div class="relative"><select id="med-type" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 text-base appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary focus:bg-white dark:focus:bg-slate-900 transition-all text-slate-900 dark:text-white font-medium shadow-sm"><option value="" data-lang-key="opt_select">Î•Ï€Î¯Î»ÎµÎ¾Îµ ÎµÎ¯Î´Î¿Ï‚</option><option value="pills" data-lang-key="opt_pills">ğŸ’Š Î§Î¬Ï€Î¹Î± / ÎšÎ¬ÏˆÎ¿Ï…Î»ÎµÏ‚</option><option value="syrup" data-lang-key="opt_syrup">ğŸ§´ Î£Î¹ÏÏŒÏ€Î¹ / Î ÏŒÏƒÎ¹Î¼Î¿</option><option value="cream" data-lang-key="opt_cream">ğŸ§´ Î‘Î»Î¿Î¹Ï†Î® / ÎšÏÎ­Î¼Î±</option><option value="spray" data-lang-key="opt_spray">ğŸ’¨ Î•Î¹ÏƒÏ€Î½ÎµÏŒÎ¼ÎµÎ½Î¿ / Î£Ï€ÏÎ­Î¹</option><option value="inject" data-lang-key="opt_inject">ğŸ’‰ Î•Î½Î­ÏƒÎ¹Î¼Î¿</option><option value="other" data-lang-key="opt_other">â“ Î†Î»Î»Î¿</option></select><i class="ph ph-caret-down absolute right-4 top-4 text-slate-500 pointer-events-none text-lg" aria-hidden="true"></i></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-slate-50 dark:bg-slate-800/80 rounded-2xl p-4 border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-primary/50 transition-colors text-center"><span class="text-xs font-bold text-slate-600 dark:text-slate-300 uppercase mb-3 block" data-lang-key="media" id="media-label">ğŸ“¸ Î¦Ï‰Ï„Î¿ / Barcode</span><div class="grid grid-cols-2 gap-3" aria-labelledby="media-label"><input id="request-image" type="file" accept="image/*" capture="environment" class="hidden" onchange="handleFileSelect(this)"><button type="button" onclick="document.getElementById('request-image').click()" aria-label="Î›Î®ÏˆÎ· Î® ÎµÏ€Î¹Î»Î¿Î³Î® Ï†Ï‰Ï„Î¿Î³ÏÎ±Ï†Î¯Î±Ï‚" class="flex flex-col items-center justify-center bg-white dark:bg-slate-700 border-2 border-slate-200 dark:border-slate-600 rounded-xl p-4 hover:shadow-md transition-all group active:scale-95"><i class="ph ph-camera text-3xl text-slate-600 dark:text-slate-300 mb-1 group-hover:text-blue-500 transition-colors" aria-hidden="true"></i><span class="text-xs font-semibold text-slate-600 dark:text-slate-300">Photo</span></button><button type="button" onclick="toggleScanner()" aria-label="Î£Î¬ÏÏ‰ÏƒÎ· Barcode" class="flex flex-col items-center justify-center bg-white dark:bg-slate-700 border-2 border-slate-200 dark:border-slate-600 rounded-xl p-4 hover:shadow-md transition-all group active:scale-95"><i class="ph ph-barcode text-3xl text-slate-600 dark:text-slate-300 mb-1 group-hover:text-teal-500 transition-colors" aria-hidden="true"></i><span class="text-xs font-semibold text-slate-600 dark:text-slate-300">Scan</span></button></div><div id="scanner-container" class="hidden mt-4 rounded-xl overflow-hidden relative bg-black border-2 border-primary h-64 shadow-lg"><div id="reader" style="width:100%;height:100%;"></div></div><div id="media-preview" class="hidden mt-2 text-xs text-teal-600 font-bold" role="status">File Uploaded!</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2"><label for="notes" class="text-xs font-bold text-slate-700 dark:text-slate-300 uppercase ml-1" data-lang-key="notes">Î£Î·Î¼ÎµÎ¹Ï‰ÏƒÎµÎ¹Ï‚</label><textarea id="notes" rows="2" placeholder="..." class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-2xl px-4 py-3.5 text-base resize-none focus:ring-2 focus:ring-primary/50 outline-none dark:text-white"></textarea></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-3 pt-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="flex items-start gap-3 px-3 cursor-pointer group bg-slate-50 dark:bg-slate-800/50 p-2 rounded-xl active:bg-slate-100 dark:active:bg-slate-800"><input type="checkbox" id="accept-generic" class="mt-1 w-5 h-5 text-primary rounded border-gray-300 focus:ring-offset-0" checked aria-label="Î‘Ï€Î¿Î´Î¿Ï‡Î® Î³ÎµÎ½ÏŒÏƒÎ·Î¼Î¿Ï…"><span class="text-xs text-slate-600 dark:text-slate-300"><span data-lang-key="accept_text">Î”Î­Ï‡Î¿Î¼Î±Î¹ Î½Î± Î¼Î¿Ï… Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Ï…Î½</span> <a href="#" onclick="openModal('generic'); return false;" class="font-bold underline decoration-dotted text-primary hover:text-teal-700 focus:outline-none focus:ring-2 focus:ring-primary rounded" data-lang-key="accept_link">Î³ÎµÎ½ÏŒÏƒÎ·Î¼Î¿</a>.</span></label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="flex items-start gap-3 px-3 cursor-pointer"><input type="checkbox" id="gdpr-check" class="mt-0.5 w-5 h-5 text-primary rounded border-gray-300 focus:ring-offset-0" required aria-label="Î‘Ï€Î¿Î´Î¿Ï‡Î® ÏŒÏÏ‰Î½ Ï‡ÏÎ®ÏƒÎ·Ï‚ ÎºÎ±Î¹ GDPR"><span class="text-xs text-slate-500 dark:text-slate-400"><span data-lang-key="terms_agree">Î‘Ï€Î¿Î´Î­Ï‡Î¿Î¼Î±Î¹ Ï„Î¿Ï…Ï‚</span> <a href="#" onclick="openModal('terms'); return false;" class="underline text-primary font-semibold focus:outline-none focus:ring-2 focus:ring-primary rounded" data-lang-key="terms_link">ÎŒÏÎ¿Ï…Ï‚ Î§ÏÎ®ÏƒÎ·Ï‚</a> & <a href="#" onclick="openModal('gdpr'); return false;" class="underline text-primary font-semibold focus:outline-none focus:ring-2 focus:ring-primary rounded" data-lang-key="gdpr_link">GDPR</a>.</span></label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-gradient-to-r from-cyan-500 to-teal-500 hover:from-cyan-600 hover:to-teal-600 text-white text-lg font-bold py-4 rounded-2xl shadow-lg shadow-teal-500/30 transform active:scale-[0.98] transition-all flex items-center justify-center gap-2 focus:outline-none focus:ring-4 focus:ring-teal-200"><i class="ph ph-paper-plane-right text-xl" aria-hidden="true"></i> <span data-lang-key="send">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="tab-results" class="tab-content" role="tabpanel">
Â  Â  Â  Â  Â  Â  <div class="glass-card rounded-3xl p-6 min-h-[50vh] text-center">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="loading-state" role="status" aria-live="polite">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-center gap-4 mb-6 text-4xl">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="animate-bounce delay-100">ğŸ’Š</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="animate-bounce delay-200">ğŸ©¹</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="animate-bounce delay-300">ğŸ©º</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="animate-bounce delay-100">ğŸ§ª</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 id="loading-text" class="text-xl font-bold text-primary mb-2">Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·...</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Î•Î¹Î´Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î± Ï†Î±ÏÎ¼Î±ÎºÎµÎ¯Î± ÎºÎ¿Î½Ï„Î¬ ÏƒÎ±Ï‚.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="resetApp()" class="mt-4 text-red-400 text-sm font-bold hover:text-red-500 active:scale-95 border border-red-200 rounded-lg px-4 py-2">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="responses-list" class="space-y-4 text-left hidden mt-4" aria-live="polite"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="pickup-view" class="hidden animate-fadeIn" role="region" aria-label="Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î Î±ÏÎ±Î»Î±Î²Î®Ï‚">
Â  Â  Â  Â  Â  Â  <div class="glass-card rounded-3xl p-8 text-center border-2 border-teal-500 dark:border-teal-700">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-24 h-24 bg-teal-100 dark:bg-teal-900/50 rounded-full flex items-center justify-center mx-auto mb-6 shadow-xl ring-8 ring-teal-50 dark:ring-teal-900/20" aria-hidden="true"><i class="ph ph-check-circle text-4xl text-primary"></i></div>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-1">ÎšÏÎ±Ï„Î®Î¸Î·ÎºÎµ!</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">ÎŸ Ï†Î±ÏÎ¼Î±ÎºÎ¿Ï€Î¿Î¹ÏŒÏ‚ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-white dark:bg-slate-700 rounded-2xl p-4 mb-6 shadow-inner border border-slate-200 dark:border-slate-600"><p class="text-xs text-slate-500 dark:text-slate-300 font-bold uppercase mb-1">Î§ÏÎ¿Î½Î¿Ï‚ Î Î±ÏÎ±Î»Î±Î²Î·Ï‚</p><div id="timer-display" class="text-5xl font-mono font-bold text-primary dark:text-teal-400 tracking-tighter" role="timer" aria-live="off">60:00</div><p class="text-xs text-slate-400 mt-2">Î Î±ÏÎ±ÎºÎ±Î»Ï Ï€Î±ÏÎ±Î»Î¬Î²ÎµÏ„Îµ ÎµÎ½Ï„ÏŒÏ‚ Ï„Î¿Ï… Ï‡ÏÏŒÎ½Î¿Ï….</p></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="border-t border-dashed border-slate-300 dark:border-slate-600 my-4 pt-4"><p class="text-xs text-slate-500 dark:text-slate-300 font-bold uppercase mb-2">ÎšÏ‰Î´Î¹ÎºÎ¿Ï‚ Î Î±ÏÎ±Î»Î±Î²Î·Ï‚</p><div id="pickup-code" class="text-3xl font-mono font-bold text-slate-800 dark:text-white tracking-[0.2em] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-600 py-3 rounded-xl" aria-label="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ Ï€Î±ÏÎ±Î»Î±Î²Î®Ï‚">------</div><p class="text-[10px] text-slate-400 mt-2">Î”ÎµÎ¯Î¾Ï„Îµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏ‰Î´Î¹ÎºÏŒ ÏƒÏ„Î¿ Ï†Î±ÏÎ¼Î±ÎºÎµÎ¯Î¿.</p></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="openGoogleMaps()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl mb-3 flex items-center justify-center gap-2 shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-300 active:scale-95"><i class="ph ph-map-trifold text-lg" aria-hidden="true"></i> Î§Î¬ÏÏ„Î·Ï‚</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="resetApp()" class="text-slate-400 text-sm underline hover:text-slate-600 dark:hover:text-slate-200 active:scale-95">ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="tab-history" class="tab-content" role="tabpanel">
Â  Â  Â  Â  Â  Â  <div class="glass-card rounded-3xl p-6 min-h-[50vh]"><h3 class="text-xl font-bold mb-6 flex items-center gap-2 text-slate-800 dark:text-white"><i class="ph ph-clock-counter-clockwise text-primary" aria-hidden="true"></i> Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ</h3><div id="history-list" class="space-y-4" role="list"><p class="text-center text-slate-400 text-sm py-10">Î£Ï…Î½Î´ÎµÎ¸ÎµÎ¯Ï„Îµ Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¿ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ ÏƒÎ±Ï‚.</p></div><div class="mt-6 text-center"><button onclick="switchTab('search')" class="text-sm text-teal-600 hover:underline active:scale-95">Î•Ï€Î¹ÏƒÏ„ÏÎ¿Ï†Î®</button></div></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="tab-how" class="tab-content" role="tabpanel" aria-labelledby="btn-how">
Â  Â  Â  Â  Â  Â  <div class="glass-card rounded-3xl p-6"><h3 class="text-xl font-bold mb-6 text-slate-800 dark:text-white flex items-center gap-2"><i class="ph ph-info text-primary" aria-hidden="true"></i> Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯;</h3><ul class="space-y-6"><li class="flex gap-4 items-start"><div class="bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300 w-10 h-10 rounded-full flex items-center justify-center font-bold flex-shrink-0 text-lg shadow-sm" aria-hidden="true">1</div><div><h4 class="font-bold text-slate-800 dark:text-slate-200">Î‘Î¯Ï„Î·Î¼Î±</h4><p class="text-slate-600 dark:text-slate-400 text-sm mt-1">Î£Ï…Î¼Ï€Î»Î·ÏÏÎ½ÎµÎ¹Ï‚ Ï„Î· Ï†ÏŒÏÎ¼Î±, Î±Î½ÎµÎ²Î¬Î¶ÎµÎ¹Ï‚ Ï†Ï‰Ï„ÏŒ Î® ÏƒÎ±ÏÏÎ½ÎµÎ¹Ï‚ Ï„Î¿ barcode.</p></div></li><li class="flex gap-4 items-start"><div class="bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300 w-10 h-10 rounded-full flex items-center justify-center font-bold flex-shrink-0 text-lg shadow-sm" aria-hidden="true">2</div><div><h4 class="font-bold text-slate-800 dark:text-slate-200">Î•Î¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ·</h4><p class="text-slate-600 dark:text-slate-400 text-sm mt-1">Î¤Î¿ MediRadar ÏˆÎ¬Ï‡Î½ÎµÎ¹ ÏƒÏ„Î± Ï†Î±ÏÎ¼Î±ÎºÎµÎ¯Î± ÎºÎ¿Î½Ï„Î¬ ÏƒÏ„Î·Î½ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± ÏƒÎ¿Ï….</p></div></li><li class="flex gap-4 items-start"><div class="bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300 w-10 h-10 rounded-full flex items-center justify-center font-bold flex-shrink-0 text-lg shadow-sm" aria-hidden="true">3</div><div><h4 class="font-bold text-slate-800 dark:text-slate-200">ÎšÏÎ¬Ï„Î·ÏƒÎ·</h4><p class="text-slate-600 dark:text-slate-400 text-sm mt-1">Î›Î±Î¼Î²Î¬Î½ÎµÎ¹Ï‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚, ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹Ï‚ Ï†Î±ÏÎ¼Î±ÎºÎµÎ¯Î¿ ÎºÎ±Î¹ Ï€Î±ÏÎ±Î»Î±Î¼Î²Î¬Î½ÎµÎ¹Ï‚!</p></div></li></ul></div>
Â  Â  Â  Â  </div>
Â  Â  </main>

Â  Â  <footer class="mt-auto py-8 bg-slate-100 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 z-10" role="contentinfo">
Â  Â  Â  Â  <div class="max-w-lg mx-auto px-6 text-center">
Â  Â  Â  Â  Â  Â  <div class="flex justify-center gap-6 mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#" aria-label="Facebook" class="text-slate-400 hover:text-primary transition-colors"><i class="ph ph-facebook-logo text-2xl" aria-hidden="true"></i></a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#" aria-label="Instagram" class="text-slate-400 hover:text-primary transition-colors"><i class="ph ph-instagram-logo text-2xl" aria-hidden="true"></i></a>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#" aria-label="Twitter" class="text-slate-400 hover:text-primary transition-colors"><i class="ph ph-twitter-logo text-2xl" aria-hidden="true"></i></a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="flex flex-wrap justify-center gap-4 text-xs font-bold text-slate-500 mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#" onclick="openModal('terms'); return false;" class="hover:text-primary">ÎŒÏÎ¿Î¹ Î§ÏÎ®ÏƒÎ·Ï‚</a>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-slate-300">|</span>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#" onclick="openModal('gdpr'); return false;" class="hover:text-primary">GDPR</a>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-slate-300">|</span>
Â  Â  Â  Â  Â  Â  Â  Â  <a href="#" onclick="openModal('pro'); return false;" class="hover:text-primary text-teal-600 dark:text-teal-400">Î¦Î±ÏÎ¼Î±ÎºÎ¿Ï€Î¿Î¹Î¿Î¯ (Pro)</a>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <p class="text-[10px] text-slate-400 uppercase tracking-widest">Â© 2025 MediRadar Hellas</p>
Â  Â  Â  Â  </div>
Â  Â  </footer>

Â  Â  <div id="a11y-widget" class="fixed bottom-6 left-4 z-50">
Â  Â  Â  Â  <button id="a11y-btn" onclick="toggleA11yMenu()" aria-label="Î•ÏÎ³Î±Î»ÎµÎ¯Î± Î ÏÎ¿ÏƒÎ²Î±ÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±Ï‚" aria-expanded="false" class="w-12 h-12 bg-primary hover:bg-teal-700 text-white rounded-full shadow-lg flex items-center justify-center transition-all hover:scale-110 focus:outline-none focus:ring-4 focus:ring-teal-300"><i class="ph ph-person-arms-spread text-2xl" aria-hidden="true"></i></button>
Â  Â  Â  Â  <div id="a11y-menu" class="hidden absolute bottom-14 left-0 w-64 glass-card bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-2xl origin-bottom-left animate-slide-up" role="dialog" aria-labelledby="a11y-title">
Â  Â  Â  Â  Â  Â  <h3 id="a11y-title" class="text-sm font-bold text-slate-700 dark:text-white uppercase mb-3 flex items-center gap-2"><i class="ph ph-eye"></i> Î ÏÎ¿ÏƒÎ²Î±ÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±</h3>
Â  Â  Â  Â  Â  Â  <div class="space-y-2">
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleFontSize()" class="w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-medium text-slate-700 dark:text-slate-200 flex items-center gap-3 transition-colors"><i class="ph ph-text-aa text-lg text-primary"></i> ÎœÎµÎ³Î¬Î»Î± Î“ÏÎ¬Î¼Î¼Î±Ï„Î±</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleContrast()" class="w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-medium text-slate-700 dark:text-slate-200 flex items-center gap-3 transition-colors"><i class="ph ph-circle-half text-lg text-primary"></i> Î¥ÏˆÎ·Î»Î® Î‘Î½Ï„Î¯Î¸ÎµÏƒÎ·</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleGrayscale()" class="w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-medium text-slate-700 dark:text-slate-200 flex items-center gap-3 transition-colors"><i class="ph ph-drop-slash text-lg text-primary"></i> Î‘ÏƒÏ€ÏÏŒÎ¼Î±Ï…ÏÎ¿</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleReadableFont()" class="w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-medium text-slate-700 dark:text-slate-200 flex items-center gap-3 transition-colors"><i class="ph ph-text-t text-lg text-primary"></i> Î‘Ï€Î»Î® Î“ÏÎ±Î¼Î¼Î±Ï„Î¿ÏƒÎµÎ¹ÏÎ¬</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="toggleLinksHighlight()" class="w-full text-left px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 text-sm font-medium text-slate-700 dark:text-slate-200 flex items-center gap-3 transition-colors"><i class="ph ph-link text-lg text-primary"></i> Î¥Ï€Î¿Î³ÏÎ¬Î¼Î¼Î¹ÏƒÎ· Links</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="border-t border-slate-200 dark:border-slate-700 my-2 pt-2"><button onclick="resetA11y()" class="w-full text-center text-xs text-red-500 hover:text-red-700 font-bold uppercase tracking-wider py-1">Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ±</button></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="modal-safety" class="modal-backdrop">
Â  Â  Â  Â  <div class="modal-content bg-white dark:bg-slate-800 text-center relative glass-card !opacity-100 !transform-none animate-slide-up">
Â  Â  Â  Â  Â  Â  <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-600"><i class="ph ph-warning-circle text-3xl"></i></div>
Â  Â  Â  Â  Â  Â  <h3 class="text-xl font-bold mb-2 text-slate-900 dark:text-white">Î£Î·Î¼Î±Î½Ï„Î¹ÎºÎ® Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·</h3>
Â  Â  Â  Â  Â  Â  <div class="bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800 p-4 rounded-xl mb-4 text-left space-y-2">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-700 dark:text-slate-300 leading-relaxed"><strong>Î‘Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î•Ï…Î¸ÏÎ½Î·Ï‚:</strong> Î¤Î¿ MediRadar ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± Ï„Î· Î´Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±. Î”ÎµÎ½ Ï†Î­ÏÎ¿Ï…Î¼Îµ ÎµÏ…Î¸ÏÎ½Î· Î³Î¹Î± Î¹Î±Ï„ÏÎ¹ÎºÎ­Ï‚ ÏƒÏ…Î¼Î²Î¿Ï…Î»Î­Ï‚ Î® Ï€Î±ÏÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-700 dark:text-slate-300 leading-relaxed">âš ï¸ Î•Î¯ÏƒÏ„Îµ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ Ï…Ï€ÎµÏÎ¸Ï…Î½Î¿Î¹ Î½Î± ÎµÎ½Î·Î¼ÎµÏÏÏƒÎµÏ„Îµ Ï„Î¿Î½ Ï†Î±ÏÎ¼Î±ÎºÎ¿Ï€Î¿Î¹ÏŒ Î³Î¹Î± Ï„Ï…Ï‡ÏŒÎ½ <strong>Î±Î»Î»ÎµÏÎ³Î¯ÎµÏ‚</strong> Î® Î¬Î»Î»Î· Ï†Î±ÏÎ¼Î±ÎºÎµÏ…Ï„Î¹ÎºÎ® Î±Î³Ï‰Î³Î® ÎºÎ±Ï„Î¬ Ï„Î·Î½ Ï€Î±ÏÎ±Î»Î±Î²Î®.</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button onclick="confirmBooking()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-xl shadow-lg transition-all active:scale-95 mb-3">ÎˆÏ‡Ï‰ ÎµÎ½Î·Î¼ÎµÏÏ‰Î¸ÎµÎ¯ & Î£Ï…Î½ÎµÏ‡Î¯Î¶Ï‰</button>
Â  Â  Â  Â  Â  Â  <button onclick="closeModal('safety')" class="text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 text-sm font-medium">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  Â  Â  <div id="modal-user" class="modal-backdrop">
Â  Â  Â  Â  <div class="modal-content bg-white dark:bg-slate-800 text-center relative glass-card !opacity-100 !transform-none animate-slide-up">
Â  Â  Â  Â  Â  Â  <button onclick="closeModal('user')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-90"><i class="ph ph-x text-xl" aria-hidden="true"></i></button>
Â  Â  Â  Â  Â  Â  <div class="w-16 h-16 bg-teal-100 dark:bg-teal-900/50 rounded-full flex items-center justify-center mx-auto mb-4 text-primary ring-4 ring-teal-50 dark:ring-teal-900/20"><i class="ph ph-user-circle text-3xl" aria-hidden="true"></i></div>
Â  Â  Â  Â  Â  Â  <h3 class="text-xl font-bold mb-1 text-slate-800 dark:text-white">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ / Î•Î³Î³ÏÎ±Ï†Î®</h3>
Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-500 dark:text-slate-400 mb-4">Î§Ï‰ÏÎ¯Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚! Î£Î±Ï‚ ÏƒÏ„Î­Î»Î½Î¿Ï…Î¼Îµ Î­Î½Î± link ÏƒÏ„Î¿ email.</p>
Â  Â  Â  Â  Â  Â  <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 p-3 rounded-xl text-left mb-4 flex gap-3">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xl" aria-hidden="true">ğŸ“§</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs text-slate-600 dark:text-slate-300 leading-relaxed"><strong>Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯:</strong><br>1. Î“ÏÎ¬Ï†ÎµÏ„Îµ Ï„Î¿ email ÏƒÎ±Ï‚.<br>2. Î Î±Ï„Î¬Ï„Îµ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯.<br>3. Î‘Î½Î¿Î¯Î³ÎµÏ„Îµ Ï„Î¿ email ÎºÎ±Î¹ Ï€Î±Ï„Î¬Ï„Îµ Ï„Î¿ link!</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <form id="magic-link-form" class="space-y-3" onsubmit="handleMagicLink(event)">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-left"><label for="user-email" class="text-xs font-bold text-slate-500 ml-2 uppercase">Email</label><input id="user-email" type="email" placeholder="onoma@email.com" required class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-xl px-4 py-3.5 text-base focus:outline-none focus:ring-2 focus:ring-primary/50 dark:text-white transition-all font-medium"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-primary hover:bg-teal-700 text-white font-bold py-3.5 rounded-xl flex items-center justify-center gap-2 shadow-lg shadow-teal-500/20 transition-all transform active:scale-[0.98]"><i class="ph ph-paper-plane-tilt text-lg" aria-hidden="true"></i> Î£Ï„ÎµÎ¯Î»Ï„Îµ Î¼Î¿Ï… Link</button>
Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  <div class="relative my-6"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-slate-200 dark:border-slate-700"></div></div><div class="relative flex justify-center text-xs uppercase"><span class="bg-white dark:bg-slate-800 px-2 text-slate-400">Î‰</span></div></div>
Â  Â  Â  Â  Â  Â  <button onclick="handleGoogleLogin()" class="w-full bg-white border-2 border-slate-200 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-white font-bold py-3 rounded-xl flex items-center justify-center gap-3 transition-all active:scale-95 shadow-sm"><svg class="w-5 h-5" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"/><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"/><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"/><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"/></svg>Î£Ï…Î½Î­Ï‡ÎµÎ¹Î± Î¼Îµ Google</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div id="modal-pro" class="modal-backdrop">
Â  Â  Â  Â  <div class="modal-content bg-white dark:bg-slate-800 text-center relative glass-card !opacity-100 !transform-none animate-slide-up !max-w-md">
Â  Â  Â  Â  Â  Â  <button onclick="closeModal('pro')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-white transition-colors active:scale-90"><i class="ph ph-x text-xl" aria-hidden="true"></i></button>
Â  Â  Â  Â  Â  Â  <div class="flex bg-slate-100 dark:bg-slate-700/50 p-1 rounded-xl mb-6">
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="switchProAuthTab('login')" id="btn-pro-login" class="flex-1 py-2 rounded-lg text-xs font-bold shadow-sm bg-white dark:bg-slate-600 text-primary transition-all">Î£ÏÎ½Î´ÎµÏƒÎ·</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="switchProAuthTab('register')" id="btn-pro-register" class="flex-1 py-2 rounded-lg text-xs font-bold text-slate-500 dark:text-slate-400 hover:text-slate-700 transition-all">Î•Î³Î³ÏÎ±Ï†Î®</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="pro-login-content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4 text-white shadow-lg"><i class="ph ph-briefcase text-3xl"></i></div>
Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-xl font-bold mb-2 text-slate-800 dark:text-white">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ Pro</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Î Î»Î±Ï„Ï†ÏŒÏÎ¼Î± Î¦Î±ÏÎ¼Î±ÎºÎ¿Ï€Î¿Î¹ÏÎ½</p>
Â  Â  Â  Â  Â  Â  Â  Â  <form class="space-y-3" onsubmit="window.location.href='pharmacy.html'; return false;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-left"><label class="text-xs font-bold text-slate-500 ml-2 uppercase">Email</label><input type="email" placeholder="pharmacy@example.com" class="w-full bg-slate-100 dark:bg-slate-800 border-2 border-slate-300 dark:border-slate-600 rounded-xl px-4 py-3 text-base focus:outline-none focus:ring-2 focus:ring-slate-500 dark:text-white transition-all font-medium"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-3 rounded-xl transition-all shadow-lg flex items-center justify-center gap-2 mt-4"><span>Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ ÏƒÏ„Î¿ Portal</span> <i class="ph ph-arrow-right"></i></button>
Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="pro-register-content" class="hidden text-left space-y-3 h-[60vh] overflow-y-auto pr-2">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-xl font-bold text-center mb-4 text-slate-800 dark:text-white">ÎÎ­Î± Î•Î³Î³ÏÎ±Ï†Î®</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <form onsubmit="handleProRegistration(event)" class="space-y-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-3"><div><label class="text-[10px] font-bold text-slate-500 uppercase">Î•Ï€Ï‰Î½Ï…Î¼Î¹Î±</label><input id="reg-name" type="text" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div><div><label class="text-[10px] font-bold text-slate-500 uppercase">Î‘Î¦Îœ</label><input id="reg-afm" type="text" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><label class="text-[10px] font-bold text-slate-500 uppercase">Î‘Ï. Î‘Î´ÎµÎ¹Î±Ï‚</label><input id="reg-license" type="text" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><label class="text-[10px] font-bold text-slate-500 uppercase">Î”Î¹ÎµÏ…Î¸Ï…Î½ÏƒÎ·</label><input id="reg-address" type="text" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><label class="text-[10px] font-bold text-slate-500 uppercase">Î¥Ï€ÎµÏ…Î¸Ï…Î½Î¿Ï‚</label><input id="reg-contact" type="text" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><label class="text-[10px] font-bold text-slate-500 uppercase">Email</label><input id="reg-email" type="email" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><label class="text-[10px] font-bold text-slate-500 uppercase">Î¤Î·Î»ÎµÏ†Ï‰Î½Î¿</label><input id="reg-phone" type="tel" required class="w-full bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg px-3 py-2.5 text-sm outline-none focus:border-primary"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="w-full bg-primary hover:bg-teal-700 text-white font-bold py-3 rounded-xl transition-all shadow-lg mt-4">Î¥Ï€Î¿Î²Î¿Î»Î® Î‘Î¯Ï„Î·ÏƒÎ·Ï‚</button>
Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  Â  Â  <div id="modal-generic" class="modal-backdrop">
Â  Â  Â  Â  <div class="modal-content bg-white dark:bg-slate-800 text-center relative glass-card !opacity-100 !transform-none">
Â  Â  Â  Â  Â  Â  <button onclick="closeModal('generic')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 dark:hover:text-white active:scale-90"><i class="ph ph-x text-xl" aria-hidden="true"></i></button>
Â  Â  Â  Â  Â  Â  <div class="w-14 h-14 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl"><i class="ph ph-pill" aria-hidden="true"></i></div>
Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-bold mb-2 text-slate-900 dark:text-white" data-lang-key="modal_generic_title">Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î³ÎµÎ½ÏŒÏƒÎ·Î¼Î¿;</h3>
Â  Â  Â  Â  Â  Â  <p class="text-sm text-slate-600 dark:text-slate-300 mb-4 text-left leading-relaxed" data-lang-key="modal_generic_body">
Â  Â  Â  Â  Â  Â  Â  Â  ÎˆÎ½Î± Î³ÎµÎ½ÏŒÏƒÎ·Î¼Î¿ Ï†Î¬ÏÎ¼Î±ÎºÎ¿ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î·Î½ <strong>Î¯Î´Î¹Î± Î±ÎºÏÎ¹Î²ÏÏ‚ Î´ÏÎ±ÏƒÏ„Î¹ÎºÎ® Î¿Ï…ÏƒÎ¯Î±</strong>, ÏƒÏ„Î·Î½ Î¯Î´Î¹Î± Ï€Î¿ÏƒÏŒÏ„Î·Ï„Î± ÎºÎ±Î¹ Î­Ï‡ÎµÎ¹ Ï„Î·Î½ Î¯Î´Î¹Î± Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Î¼Îµ Ï„Î¿ Ï€ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î¿ Ï†Î¬ÏÎ¼Î±ÎºÎ¿.<br><br>
Â  Â  Â  Â  Â  Â  Â  Â  Î•Î¯Î½Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ <strong>Ï€Î¹Î¿ Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÏŒ</strong> ÎºÎ±Î¹ ÎµÎ³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Î±Ï€ÏŒ Ï„Î¿Î½ Î•ÎŸÎ¦. Î•Ï€Î¹Î»Î­Î³Î¿Î½Ï„Î±Ï‚ Î³ÎµÎ½ÏŒÏƒÎ·Î¼Î¿, ÎµÎ¾Ï…Ï€Î·ÏÎµÏ„ÎµÎ¯ÏƒÏ„Îµ Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ± Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î»Î»ÎµÎ¹ÏˆÎ· ÏƒÏ„Î¿ Ï€ÏÏ‰Ï„ÏŒÏ„Ï…Ï€Î¿.
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  <button onclick="closeModal('generic')" class="bg-blue-600 text-white px-6 py-2 rounded-xl text-sm font-bold shadow-lg hover:bg-blue-700 transition-colors active:scale-95">ÎšÎ±Ï„Î¬Î»Î±Î²Î±</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div id="modal-terms" class="modal-backdrop"><div class="modal-content bg-white dark:bg-slate-800 relative p-6 h-[80vh] overflow-y-auto"><button onclick="closeModal('terms')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿" class="absolute top-4 right-4 text-slate-500 active:scale-90"><i class="ph ph-x text-xl" aria-hidden="true"></i></button><h3 class="font-bold text-xl mb-4 text-slate-800 dark:text-white">ÎŒÏÎ¿Î¹ Î§ÏÎ®ÏƒÎ·Ï‚</h3><p class="text-sm text-slate-600 dark:text-slate-300">Î¤Î¿ MediRadar ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± ÎµÏÏÎµÏƒÎ·Ï‚ Ï†Î±ÏÎ¼Î¬ÎºÏ‰Î½... (ÎšÎµÎ¯Î¼ÎµÎ½Î¿ ÎŒÏÏ‰Î½)...</p></div></div>
Â  Â  <div id="modal-gdpr" class="modal-backdrop"><div class="modal-content bg-white dark:bg-slate-800 relative p-6 h-[80vh] overflow-y-auto"><button onclick="closeModal('gdpr')" aria-label="ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿" class="absolute top-4 right-4 text-slate-500 active:scale-90"><i class="ph ph-x text-xl" aria-hidden="true"></i></button><h3 class="font-bold text-xl mb-4 text-slate-800 dark:text-white">GDPR & Î‘Ï€ÏŒÏÏÎ·Ï„Î¿</h3><p class="text-sm text-slate-600 dark:text-slate-300">Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎ±Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î¼ÏŒÎ½Î¿ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï„Î¿Ï… Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚... (ÎšÎµÎ¯Î¼ÎµÎ½Î¿ GDPR)...</p></div></div>

Â  Â  <script>
Â  Â  Â  Â  const SB_URL = "https://qzerrisyowkfkmcyxmav.supabase.co";
Â  Â  Â  Â  const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF6ZXJyaXN5b3drZmttY3l4bWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwMTcxODQsImV4cCI6MjA3NTU5MzE4NH0.alkvHkOQPBTwY3daUcKAEsf4nt0kizuU3rYI2c2InPk";

Â  Â  Â  Â  const citiesData = ["Î‘Î¸Î®Î½Î±", "Î˜ÎµÏƒÏƒÎ±Î»Î¿Î½Î¯ÎºÎ·", "Î Î¬Ï„ÏÎ±", "Î—ÏÎ¬ÎºÎ»ÎµÎ¹Î¿", "Î›Î¬ÏÎ¹ÏƒÎ±", "Î’ÏŒÎ»Î¿Ï‚", "Î™Ï‰Î¬Î½Î½Î¹Î½Î±", "Î¤ÏÎ¯ÎºÎ±Î»Î±", "Î§Î±Î»ÎºÎ¯Î´Î±", "Î£Î­ÏÏÎµÏ‚", "Î ÎµÎ¹ÏÎ±Î¹Î¬Ï‚", "Î ÎµÏÎ¹ÏƒÏ„Î­ÏÎ¹", "ÎšÎ±Î»Î»Î¹Î¸Î­Î±", "Î“Î»Ï…Ï†Î¬Î´Î±", "ÎœÎ±ÏÎ¿ÏÏƒÎ¹", "ÎšÎ·Ï†Î¹ÏƒÎ¹Î¬"];
Â  Â  Â  Â  const medicinesData = ["Depon", "Panadol", "Algofren", "Mesulid", "Voltaren", "Augmentin", "Amoxil", "Aerolin", "Ponstan", "Buscopan", "Ibuprofen", "Paracetamol", "Aspirin", "Zirtek", "Clarityne"];

Â  Â  Â  Â  const translations = {
Â  Â  Â  Â  Â  Â  el: { search_tab: "Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·", how_tab: "Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯", name: "ÎŒÎ½Î¿Î¼Î±", phone: "Î¤Î·Î»Î­Ï†Ï‰Î½Î¿", area: "Î ÎµÏÎ¹Î¿Ï‡Î®", near_me: "ÎšÎ¿Î½Ï„Î¬ Î¼Î¿Ï…", med_name: "ÎŒÎ½Î¿Î¼Î± Î¦Î±ÏÎ¼Î¬ÎºÎ¿Ï…", substance: "Î”ÏÎ±ÏƒÏ„Î¹ÎºÎ® (Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)", quantity: "Î Î¿ÏƒÏŒÏ„Î·Ï„Î±", type: "Î•Î¯Î´Î¿Ï‚ / ÎœÎ¿ÏÏ†Î®", media: "Î¦Ï‰Ï„Î¿ / Barcode", notes: "Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚", accept_text: "Î”Î­Ï‡Î¿Î¼Î±Î¹ Î½Î± Î¼Î¿Ï… Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Ï…Î½", accept_link: "Î³ÎµÎ½ÏŒÏƒÎ·Î¼Î¿", terms_agree: "Î‘Ï€Î¿Î´Î­Ï‡Î¿Î¼Î±Î¹ Ï„Î¿Ï…Ï‚", terms_link: "ÎŒÏÎ¿Ï…Ï‚ Î§ÏÎ®ÏƒÎ·Ï‚", gdpr_link: "GDPR", send: "Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î‘Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚", searching: "Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·...", opt_select: "Î•Ï€Î¯Î»ÎµÎ¾Îµ ÎµÎ¯Î´Î¿Ï‚", opt_pills: "ğŸ’Š Î§Î¬Ï€Î¹Î± / ÎšÎ¬ÏˆÎ¿Ï…Î»ÎµÏ‚", opt_syrup: "ğŸ§´ Î£Î¹ÏÏŒÏ€Î¹ / Î ÏŒÏƒÎ¹Î¼Î¿", opt_cream: "ğŸ§´ Î‘Î»Î¿Î¹Ï†Î® / ÎšÏÎ­Î¼Î±", opt_spray: "ğŸ’¨ Î•Î¹ÏƒÏ€Î½ÎµÏŒÎ¼ÎµÎ½Î¿ / Î£Ï€ÏÎ­Î¹", opt_inject: "ğŸ’‰ Î•Î½Î­ÏƒÎ¹Î¼Î¿", opt_other: "â“ Î†Î»Î»Î¿", subtitle: "Î’ÏÎµÏ‚ Ï„Î¿ Ï†Î¬ÏÎ¼Î±ÎºÏŒ ÏƒÎ¿Ï… Î¬Î¼ÎµÏƒÎ± & Ï„Î¿Ï€Î¹ÎºÎ¬." },
Â  Â  Â  Â  Â  Â  en: { search_tab: "Search", how_tab: "How it works", name: "Name", phone: "Phone", area: "City / Area", near_me: "Near Me", med_name: "Medicine Name", substance: "Active Substance", quantity: "Quantity", type: "Type / Form", media: "Photo / Barcode", notes: "Notes", accept_text: "I accept suggestions for", accept_link: "generics", terms_agree: "I accept the", terms_link: "Terms", gdpr_link: "GDPR", send: "Send Request", searching: "Searching...", opt_select: "Select type", opt_pills: "ğŸ’Š Pills", opt_syrup: "ğŸ§´ Syrup", opt_cream: "ğŸ§´ Cream", opt_spray: "ğŸ’¨ Spray", opt_inject: "ğŸ’‰ Injection", opt_other: "â“ Other", subtitle: "Find your medicine instantly & locally." }
Â  Â  Â  Â  };
Â  Â  Â  Â  let currentLang = 'el';

Â  Â  Â  Â  let userLocation = { lat: null, lon: null };
Â  Â  Â  Â  let pickupDeadline = null;
Â  Â  Â  Â  let currentRequestId = null;
Â  Â  Â  Â  let currentUser = null;
Â  Â  Â  Â  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
Â  Â  Â  Â  let html5QrcodeScanner = null;
Â  Â  Â  Â  let pickupTimer = null;
Â  Â  Â  Â  let pendingPharmacyId = null; // Stores pharmacy ID before confirmation
Â  Â  Â  Â  let intervalId = null; // For emoji rotation

Â  Â  Â  Â  window.onload = async function() {
Â  Â  Â  Â  Â  Â  createEmojis();
Â  Â  Â  Â  Â  Â  setupAutocomplete('city', 'city-suggestions', citiesData);
Â  Â  Â  Â  Â  Â  setupAutocomplete('medicine', 'drug-suggestions', medicinesData);
Â  Â  Â  Â  Â  Â  loadUserData();

Â  Â  Â  Â  Â  Â  window.db = window.supabase.createClient(SB_URL, SB_KEY);
Â  Â  Â  Â  Â  Â  const { data, error } = await window.db.auth.signInAnonymously();
Â  Â  Â  Â  Â  Â  if(!error) currentUser = data.user;
Â  Â  Â  Â  Â  Â  else showToast("Connection Error", "error");

Â  Â  Â  Â  Â  Â  if(window.db) { window.db.auth.onAuthStateChange((event, session) => { if(session) { currentUser = session.user; updateNavForUser(session.user); } }); }

Â  Â  Â  Â  Â  Â  document.getElementById('request-form').addEventListener('submit', handleFormSubmit);
Â  Â  Â  Â  };

Â  Â  Â  Â  // --- UI LOGIC ---
Â  Â  Â  Â  function switchProAuthTab(tab) {
Â  Â  Â  Â  Â  Â  const loginContent = document.getElementById('pro-login-content');
Â  Â  Â  Â  Â  Â  const registerContent = document.getElementById('pro-register-content');
Â  Â  Â  Â  Â  Â  const btnLogin = document.getElementById('btn-pro-login');
Â  Â  Â  Â  Â  Â  const btnRegister = document.getElementById('btn-pro-register');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (tab === 'login') {
Â  Â  Â  Â  Â  Â  Â  Â  loginContent.classList.remove('hidden'); registerContent.classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  btnLogin.classList.add('bg-white', 'dark:bg-slate-600', 'text-primary', 'shadow-sm'); btnLogin.classList.remove('text-slate-500', 'dark:text-slate-400');
Â  Â  Â  Â  Â  Â  Â  Â  btnRegister.classList.remove('bg-white', 'dark:bg-slate-600', 'text-primary', 'shadow-sm'); btnRegister.classList.add('text-slate-500', 'dark:text-slate-400');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  loginContent.classList.add('hidden'); registerContent.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  btnRegister.classList.add('bg-white', 'dark:bg-slate-600', 'text-primary', 'shadow-sm'); btnRegister.classList.remove('text-slate-500', 'dark:text-slate-400');
Â  Â  Â  Â  Â  Â  Â  Â  btnLogin.classList.remove('bg-white', 'dark:bg-slate-600', 'text-primary', 'shadow-sm'); btnLogin.classList.add('text-slate-500', 'dark:text-slate-400');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function handleProRegistration(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  const btn = e.target.querySelector('button');
Â  Â  Â  Â  Â  Â  const oldText = btn.innerHTML;
Â  Â  Â  Â  Â  Â  btn.innerHTML = '<i class="ph ph-spinner animate-spin"></i>'; btn.disabled = true;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const formData = {
Â  Â  Â  Â  Â  Â  Â  Â  pharmacy_name: document.getElementById('reg-name').value,
Â  Â  Â  Â  Â  Â  Â  Â  afm: document.getElementById('reg-afm').value,
Â  Â  Â  Â  Â  Â  Â  Â  license_number: document.getElementById('reg-license').value,
Â  Â  Â  Â  Â  Â  Â  Â  address: document.getElementById('reg-address').value,
Â  Â  Â  Â  Â  Â  Â  Â  contact_person: document.getElementById('reg-contact').value,
Â  Â  Â  Â  Â  Â  Â  Â  email: document.getElementById('reg-email').value,
Â  Â  Â  Â  Â  Â  Â  Â  phone: document.getElementById('reg-phone').value,
Â  Â  Â  Â  Â  Â  Â  Â  status: 'pending'
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const { error } = await window.db.from('pharmacy_registrations').insert([formData]);
Â  Â  Â  Â  Â  Â  if(error) { showToast(error.message, 'error'); btn.innerHTML = oldText; btn.disabled = false; }
Â  Â  Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  Â  Â  showToast("Î— Î±Î¯Ï„Î·ÏƒÎ· ÎµÏƒÏ„Î¬Î»Î·!", 'success');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('pro-register-content').innerHTML = `<div class="text-center py-10 animate-[fadeIn_0.5s]"><div class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl"><i class="ph ph-check"></i></div><h3 class="text-lg font-bold text-slate-800 dark:text-white">Î•Ï…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ!</h3><p class="text-sm text-slate-500 dark:text-slate-400 mt-2">Î— Î±Î¯Ï„Î·ÏƒÎ® ÏƒÎ±Ï‚ Ï€Î±ÏÎ±Î»Î®Ï†Î¸Î·ÎºÎµ.</p></div>`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function handleFormSubmit(e) {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  if(!currentUser) return showToast("Î Î±ÏÎ±ÎºÎ±Î»Ï Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÏ„Îµ...", "error");

Â  Â  Â  Â  Â  Â  const btn = e.target.querySelector('button[type="submit"]');
Â  Â  Â  Â  Â  Â  const oldText = btn.innerHTML;
Â  Â  Â  Â  Â  Â  btn.innerHTML = '<i class="ph ph-spinner animate-spin text-xl"></i> Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®...'; btn.disabled = true;

Â  Â  Â  Â  Â  Â  // Collect the generic preference
Â  Â  Â  Â  Â  Â  const acceptsGeneric = document.getElementById('accept-generic').checked;

Â  Â  Â  Â  Â  Â  const formData = {
Â  Â  Â  Â  Â  Â  Â  Â  user_id: currentUser.id,
Â  Â  Â  Â  Â  Â  Â  Â  customer_name: document.getElementById('full-name').value,
Â  Â  Â  Â  Â  Â  Â  Â  phone: document.getElementById('phone').value,
Â  Â  Â  Â  Â  Â  Â  Â  location: document.getElementById('city').value,
Â  Â  Â  Â  Â  Â  Â  Â  medicine_name: document.getElementById('medicine').value,
Â  Â  Â  Â  Â  Â  Â  Â  substance: document.getElementById('substance').value,
Â  Â  Â  Â  Â  Â  Â  Â  quantity: document.getElementById('quantity').value,
Â  Â  Â  Â  Â  Â  Â  Â  med_type: document.getElementById('med-type').value,
Â  Â  Â  Â  Â  Â  Â  Â  notes: document.getElementById('notes').value,
Â  Â  Â  Â  Â  Â  Â  Â  status: 'pending',
Â  Â  Â  Â  Â  Â  Â  Â  lat: userLocation.lat,
Â  Â  Â  Â  Â  Â  Â  Â  lon: userLocation.lon,
Â  Â  Â  Â  Â  Â  Â  Â  accepts_generic: acceptsGeneric // Send to DB
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const { data, error } = await window.db.from('requests').insert([formData]).select().single();

Â  Â  Â  Â  Â  Â  if(error) {
Â  Â  Â  Â  Â  Â  Â  Â  showToast("Î£Ï†Î¬Î»Î¼Î±: " + error.message, "error");
Â  Â  Â  Â  Â  Â  Â  Â  btn.innerHTML = oldText; btn.disabled = false;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  currentRequestId = data.id;
Â  Â  Â  Â  Â  Â  Â  Â  saveUserData();
Â  Â  Â  Â  Â  Â  Â  Â  confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: ['#0d9488', '#38bdf8'] });
Â  Â  Â  Â  Â  Â  Â  Â  switchTab('results');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // START LOADING ANIMATION TEXT
Â  Â  Â  Â  Â  Â  Â  Â  const texts = ["Î•Î¹Î´Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î± Ï†Î±ÏÎ¼Î±ÎºÎµÎ¯Î±...", "ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Ï€Î¿Î¸Î­Î¼Î±Ï„Î¿Ï‚...", "Î Î±ÏÎ±ÎºÎ±Î»Ï Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÏ„Îµ...", "Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÎµ ÎµÎ¾Î­Î»Î¹Î¾Î·..."];
Â  Â  Â  Â  Â  Â  Â  Â  let i = 0;
Â  Â  Â  Â  Â  Â  Â  Â  intervalId = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  i = (i + 1) % texts.length;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('loading-text').innerText = texts[i];
Â  Â  Â  Â  Â  Â  Â  Â  }, 2500);

Â  Â  Â  Â  Â  Â  Â  Â  listenForResponsesRobust(data.id);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function listenForResponsesRobust(reqId) {
Â  Â  Â  Â  Â  Â  window.db.channel('public:responses')
Â  Â  Â  Â  Â  Â  .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'responses' }, (payload) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (payload.new.request_id === reqId) displayResponse(payload.new);
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .subscribe();
Â  Â  Â  Â  }

Â  Â  Â  Â  function displayResponse(resp) {
Â  Â  Â  Â  Â  Â  clearInterval(intervalId); // Stop cycling text
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const list = document.getElementById('responses-list');
Â  Â  Â  Â  Â  Â  document.getElementById('loading-state').classList.add('hidden');
Â  Â  Â  Â  Â  Â  list.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  try { new Audio('https://cdn.freesound.org/previews/536/536108_10463375-lq.mp3').play().catch(e=>{}); } catch(e){}
Â  Â  Â  Â  Â  Â  showToast("Î’ÏÎ­Î¸Î·ÎºÎµ Ï†Î±ÏÎ¼Î±ÎºÎµÎ¯Î¿!", "success");

Â  Â  Â  Â  Â  Â  // Force styling to ensure visibility
Â  Â  Â  Â  Â  Â  const html = `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="glass-card bg-white p-5 rounded-2xl border-l-4 border-teal-500 animate-slide-up shadow-lg relative z-50">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-start">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 class="font-bold text-lg text-teal-700">Î¦Î±ÏÎ¼Î±ÎºÎµÎ¯Î¿ Î’ÏÎ­Î¸Î·ÎºÎµ!</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm font-semibold mt-1 text-slate-800">${resp.message}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-xs text-slate-500 mt-2">Î‘Ï€ÏŒÏƒÏ„Î±ÏƒÎ·: <span class="font-mono">${resp.distance || '0.8'} Ï‡Î»Î¼</span></p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-2xl font-bold text-slate-800">${resp.price > 0 ? resp.price+'â‚¬' : ''}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="acceptOffer('${resp.pharmacist_id}')" class="w-full mt-4 bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 rounded-xl shadow-md active:scale-95 transition-all">ÎšÏÎ¬Ï„Î·ÏƒÎ· Î¤ÏÏÎ±</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  list.innerHTML = html;
Â  Â  Â  Â  }

Â  Â  Â  Â  function acceptOffer(pharmacyId) {
Â  Â  Â  Â  Â  Â  pendingPharmacyId = pharmacyId;
Â  Â  Â  Â  Â  Â  openModal('safety');
Â  Â  Â  Â  }

Â  Â  Â  Â  async function confirmBooking() {
Â  Â  Â  Â  Â  Â  if(!currentRequestId || !pendingPharmacyId) return;
Â  Â  Â  Â  Â  Â  closeModal('safety');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const { error } = await window.db.from('requests').update({ status: 'reserved', winner_pharmacy_id: pendingPharmacyId }).eq('id', currentRequestId);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if(error) showToast(error.message, 'error');
Â  Â  Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('pickup-view').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('tab-results').classList.remove('active');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('pickup-code').innerText = currentRequestId.substring(0, 6);
Â  Â  Â  Â  Â  Â  Â  Â  startTimer();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function startTimer() {
Â  Â  Â  Â  Â  Â  let duration = 3600;Â 
Â  Â  Â  Â  Â  Â  const el = document.getElementById('timer-display');
Â  Â  Â  Â  Â  Â  pickupTimer = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  const m = Math.floor(duration / 60);
Â  Â  Â  Â  Â  Â  Â  Â  const s = duration % 60;
Â  Â  Â  Â  Â  Â  Â  Â  el.innerText = `${m}:${s<10?'0':''}${s}`;
Â  Â  Â  Â  Â  Â  Â  Â  if(--duration < 0) { clearInterval(pickupTimer); el.innerText = "Î•Î›Î—ÎÎ•"; el.classList.add('text-red-500'); }
Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  }

Â  Â  Â  Â  function toggleScanner() {
Â  Â  Â  Â  Â  Â  const c = document.getElementById('scanner-container');
Â  Â  Â  Â  Â  Â  if(!c.classList.contains('hidden')) {Â 
Â  Â  Â  Â  Â  Â  Â  Â  if(html5QrcodeScanner) html5QrcodeScanner.stop().then(() => { c.classList.add('hidden'); html5QrcodeScanner.clear(); });
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  c.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  html5QrcodeScanner = new Html5Qrcode("reader");
Â  Â  Â  Â  Â  Â  Â  Â  html5QrcodeScanner.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (t) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html5QrcodeScanner.stop().then(() => c.classList.add('hidden'));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('medicine').value = t;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast("Barcode Scanned!", 'success');
Â  Â  Â  Â  Â  Â  Â  Â  }, (e) => {});
Â  Â  Â  Â  Â  Â  }, 100);
Â  Â  Â  Â  }

Â  Â  Â  Â  function startVoiceInput() {
Â  Â  Â  Â  Â  Â  if (!SpeechRecognition) return showToast("Î”ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÏ„Î±Î¹ Ï†Ï‰Î½Î·Ï„Î¹ÎºÎ® ÎµÎ½Ï„Î¿Î»Î®", 'error');
Â  Â  Â  Â  Â  Â  const recognition = new SpeechRecognition();
Â  Â  Â  Â  Â  Â  recognition.lang = currentLang === 'el' ? 'el-GR' : 'en-US';
Â  Â  Â  Â  Â  Â  recognition.onstart = () => showToast("ÎœÎ¹Î»Î®ÏƒÏ„Îµ Ï„ÏÏÎ±...", 'info');
Â  Â  Â  Â  Â  Â  recognition.onresult = (e) => { document.getElementById('medicine').value = e.results[0][0].transcript; showToast("OK!", 'success'); };
Â  Â  Â  Â  Â  Â  recognition.start();
Â  Â  Â  Â  }

Â  Â  Â  Â  function toggleLang() {
Â  Â  Â  Â  Â  Â  currentLang = currentLang === 'el' ? 'en' : 'el';
Â  Â  Â  Â  Â  Â  document.getElementById('lang-flag').innerText = currentLang === 'el' ? 'ğŸ‡¬ğŸ‡·' : 'ğŸ‡¬ğŸ‡§';
Â  Â  Â  Â  Â  Â  document.querySelectorAll('[data-lang-key]').forEach(el => {
Â  Â  Â  Â  Â  Â  Â  Â  const key = el.getAttribute('data-lang-key');
Â  Â  Â  Â  Â  Â  Â  Â  if(translations[currentLang][key]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(['accept_text', 'terms_agree'].includes(key)) { /* Handle nested spans manually if needed, or simple replace */ }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else { el.innerText = translations[currentLang][key]; }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  // Simple update for selects/placeholders
Â  Â  Â  Â  Â  Â  if(currentLang === 'en') {Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('medicine').placeholder = "e.g. Depon";Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('city').placeholder = "City/Area...";Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('button[onclick="getLocation()"] span').innerText = "Near Me";
Â  Â  Â  Â  Â  Â  } else {Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('medicine').placeholder = "Ï€.Ï‡. Depon";Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('city').placeholder = "Î ÎµÏÎ¹Î¿Ï‡Î®...";Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelector('button[onclick="getLocation()"] span').innerText = "ÎšÎ¿Î½Ï„Î¬ Î¼Î¿Ï…";
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleFileSelect(input) { if(input.files[0]) { document.getElementById('media-preview').classList.remove('hidden'); showToast("Î— Ï†Ï‰Ï„Î¿Î³ÏÎ±Ï†Î¯Î± Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!", 'success'); } }
Â  Â  Â  Â  function switchTab(id) { document.querySelectorAll('.tab-content').forEach(e => e.classList.remove('active')); document.getElementById('tab-' + id).classList.add('active'); document.getElementById('pickup-view').classList.add('hidden'); if(id==='history') loadUserHistory(); }
Â  Â  Â  Â  function updateNavForUser(user) { if (user.is_anonymous) return; const n = user.user_metadata.full_name || (user.email ? user.email.split('@')[0] : 'User'); document.getElementById('user-nav-container').innerHTML = `<div class="flex gap-2"><button class="bg-teal-50 dark:bg-teal-900 px-3 py-2 rounded-xl text-xs font-bold text-teal-700 dark:text-teal-300 border border-teal-200 shadow-sm flex items-center gap-2"><i class="ph ph-user"></i> ${n}</button><button onclick="handleLogout()" class="bg-slate-100 dark:bg-slate-800 p-2 rounded-xl text-slate-500 hover:text-red-500"><i class="ph ph-sign-out"></i></button></div>`; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Auth Helpers
Â  Â  Â  Â  async function handleMagicLink(e) { e.preventDefault(); const email = document.getElementById('user-email').value; if(!email) return showToast("Email?", 'error'); const { error } = await window.db.auth.signInWithOtp({ email, options: { emailRedirectTo: window.location.href } }); if (error) showToast("Error: "+error.message, 'error'); else { showToast("Î•Î»Î­Î³Î¾Ï„Îµ Ï„Î¿ email ÏƒÎ±Ï‚!", 'success'); closeModal('user'); } }
Â  Â  Â  Â  async function handleGoogleLogin() { const { error } = await window.db.auth.signInWithOAuth({ provider: 'google', options: { redirectTo: window.location.href } }); if (error) showToast(error.message, 'error'); }
Â  Â  Â  Â  async function handleLogout() { await window.db.auth.signOut(); window.location.reload(); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // === Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎ— getLocation() ===
Â  Â  Â  Â  function getLocation() {
Â  Â  Â  Â  Â  Â  if(!navigator.geolocation) return showToast(currentLang === 'el' ? "Î— ÏƒÏ…ÏƒÎºÎµÏ…Î® Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ GPS." : "GPS not supported.", "error");
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const btn = document.querySelector('button[onclick="getLocation()"]');
Â  Â  Â  Â  Â  Â  const originalText = btn.innerHTML; 
Â  Â  Â  Â  Â  Â  btn.innerHTML = '<i class="ph ph-spinner animate-spin"></i>'; 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const geocodingSuccess = (position) => {
Â  Â  Â  Â  Â  Â  Â  Â  userLocation = { lat: position.coords.latitude, lon: position.coords.longitude }; // Î†Î¼ÎµÏƒÎ· Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Î ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± Reverse Geocoding
Â  Â  Â  Â  Â  Â  Â  Â  fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${userLocation.lat}&lon=${userLocation.lon}&addressdetails=1`)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .then(r => r.json())
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .then(d => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Î’ÎµÎ»Ï„Î¹Ï‰Î¼Î­Î½Î· ÎµÏÏÎµÏƒÎ· Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ Ï€ÎµÏÎ¹Î¿Ï‡Î®Ï‚
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let loc = d.address.city || d.address.town || d.address.village || d.address.road || "Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± OK";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('city').value = loc;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  saveUserData(); 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(currentLang === 'el' ? "Î’ÏÎ­Î¸Î·ÎºÎµ: " + loc : "Location found: " + loc, "success");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .catch(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('city').value = "Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showToast(currentLang === 'el' ? "Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± OK" : "Location OK", "success");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .finally(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  btn.innerHTML = originalText;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  const geocodingError = (err) => { 
Â  Â  Â  Â  Â  Â  Â  Â  showToast(currentLang === 'el' ? "Î‘Î´ÏÎ½Î±Ï„Î· Î· ÎµÏÏÎµÏƒÎ· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±Ï‚. Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Î½Î± Ï€Î»Î·ÎºÏ„ÏÎ¿Î»Î¿Î³Î®ÏƒÎµÏ„Îµ." : "Location not found. Try typing.", "error"); 
Â  Â  Â  Â  Â  Â  Â  Â  btn.innerHTML = originalText;
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  // ÎœÎµÎ¯Ï‰ÏƒÎ· timeout ÏƒÏ„Î± 2000ms
Â  Â  Â  Â  Â  Â  navigator.geolocation.getCurrentPosition(geocodingSuccess, geocodingError, { enableHighAccuracy: true, timeout: 2000, maximumAge: 0 });
Â  Â  Â  Â  }
Â  Â  Â  Â  // === Î¤Î•Î›ÎŸÎ£ Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎ—Î£ getLocation() ===

Â  Â  Â  Â  function openModal(t){document.getElementById(`modal-${t}`).classList.add('active');}
Â  Â  Â  Â  function closeModal(t){document.getElementById(`modal-${t}`).classList.remove('active');}
Â  Â  Â  Â  function createEmojis() { const c = document.getElementById('emoji-container'); const em = ['ğŸ’Š','ğŸ©º','ğŸ¥','ğŸ©¹','ğŸ§ª','ğŸ§¬','ğŸ§´']; for(let i=0; i<15; i++){ const e = document.createElement('div'); e.innerText = em[Math.floor(Math.random() * em.length)]; e.classList.add('emoji'); e.style.left = Math.random() * 100 + '%'; e.style.animationDuration = (12 + Math.random() * 20) + 's'; e.style.animationDelay = (Math.random() * 10) + 's'; c.appendChild(e); } }
Â  Â  Â  Â  function setupAutocomplete(id, boxId, data) { const inp = document.getElementById(id); const box = document.getElementById(boxId); inp.addEventListener('input', (e) => { const v = e.target.value.toLowerCase(); if(v.length < 1) { box.style.display = 'none'; return; } const m = data.filter(i => i.toLowerCase().includes(v)); box.innerHTML = m.map(i => `<div class="suggestion-item" onclick="document.getElementById('${id}').value='${i}'; document.getElementById('${boxId}').style.display='none'">${i}</div>`).join(''); box.style.display = m.length ? 'block' : 'none'; }); document.addEventListener('click', (e) => { if(!inp.contains(e.target)) box.style.display = 'none'; }); }
Â  Â  Â  Â  function toggleTheme() { document.documentElement.classList.toggle('dark'); }
Â  Â  Â  Â  // Î— toggleLang() ÎµÏ€Î±Î½Î±Î»Î±Î¼Î²Î¬Î½ÎµÏ„Î±Î¹, Î¿Ï€ÏŒÏ„Îµ ÎºÏÎ±Ï„Î¬Î¼Îµ Î¼ÏŒÎ½Î¿ Ï„Î·Î½ Ï€ÏÏÏ„Î·.
Â  Â  Â  Â  // function toggleLang() { currentLang = currentLang === 'el' ? 'en' : 'el'; showToast("Language switched (Demo)", 'info'); } 
Â  Â  Â  Â  function saveUserData() { localStorage.setItem('mr_user', JSON.stringify({ n: document.getElementById('full-name').value, p: document.getElementById('phone').value, c: document.getElementById('city').value })); }
Â  Â  Â  Â  function loadUserData() { const d = JSON.parse(localStorage.getItem('mr_user') || '{}'); if(d.n) document.getElementById('full-name').value = d.n; if(d.p) document.getElementById('phone').value = d.p; if(d.c) document.getElementById('city').value = d.c; }
Â  Â  Â  Â  function resetApp() { window.location.reload(); }
Â  Â  Â  Â  function showToast(m, t='info') { const c = document.getElementById('toast-container'); const e = document.createElement('div'); e.className = `p-3 rounded-xl shadow-lg text-white text-sm mb-2 ${t==='success'?'bg-green-500':t==='error'?'bg-red-500':'bg-slate-800'} animate-toast`; e.innerText = m; c.appendChild(e); setTimeout(()=>e.remove(), 3000); }
Â  Â  Â  Â  // === Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎ— openGoogleMaps() ===
Â  Â  Â  Â  function openGoogleMaps() { 
Â  Â  Â  Â  Â  Â  if(userLocation.lat && userLocation.lon) {
Â  Â  Â  Â  Â  Â  Â  Â  // Î§ÏÎ®ÏƒÎ· lat/lon
Â  Â  Â  Â  Â  Â  Â  Â  window.open(`https://maps.google.com/?q=${userLocation.lat},${userLocation.lon}`, '_blank');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Î§ÏÎ®ÏƒÎ· Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ Ï€ÏŒÎ»Î·Ï‚/Ï€ÎµÏÎ¹Î¿Ï‡Î®Ï‚ Ï‰Ï‚ fallback
Â  Â  Â  Â  Â  Â  Â  Â  window.open(`https://maps.google.com/?q=${document.getElementById('city').value}`, '_blank');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  // === Î¤Î•Î›ÎŸÎ£ Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎ—Î£ openGoogleMaps() ===
Â  Â  Â  Â  function toggleA11yMenu() { document.getElementById('a11y-menu').classList.toggle('hidden'); }
Â  Â  Â  Â  function resetA11y() { document.documentElement.style.fontSize = ''; document.body.className = "text-slate-800 dark:text-slate-100 antialiased min-h-screen relative flex flex-col pb-safe"; }
Â  Â  Â  Â  // Accessibility functions placeholders
Â  Â  Â  Â  function toggleFontSize() { const h = document.documentElement; h.style.fontSize = h.style.fontSize === '16px' ? '20px' : '16px'; }
Â  Â  Â  Â  function toggleContrast() { document.body.classList.toggle('a11y-high-contrast'); }
Â  Â  Â  Â  function toggleGrayscale() { document.body.classList.toggle('a11y-grayscale'); }
Â  Â  Â  Â  function toggleReadableFont() { document.body.classList.toggle('a11y-readable-font'); }
Â  Â  Â  Â  function toggleLinksHighlight() { document.body.classList.toggle('a11y-links-underline'); }
Â  Â  </script>
</body>
</html>
